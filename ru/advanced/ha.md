# Высокая доступность

Высокая доступность (High Availability, HA) в AACSearch обеспечивает бесперебойную работу поисковой системы даже в случае сбоев оборудования или программного обеспечения. Этот раздел объясняет, как AACSearch достигает высокой доступности и как вы можете настроить систему для максимальной надежности.

## Принципы высокой доступности

AACSearch использует несколько стратегий для обеспечения высокой доступности:

- **Репликация данных**: Каждый индекс имеет несколько копий (реплик), хранящихся на разных узлах. Если один узел выходит из строя, запросы перенаправляются к доступной реплике.
- **Географическое распределение**: Узлы могут быть размещены в разных регионах, чтобы минимизировать влияние локальных сбоев (например, отключения электроэнергии или сетевых проблем).
- **Автоматическое восстановление**: Система автоматически обнаруживает сбои и перенаправляет трафик к рабочим узлам, минимизируя время простоя.
- **Балансировка нагрузки**: Запросы распределяются между узлами, чтобы предотвратить перегрузку и обеспечить стабильную работу.

## Как работает HA в AACSearch

1. **Обнаружение сбоев**  
   AACSearch использует механизмы мониторинга для постоянной проверки состояния узлов. Если узел становится недоступным, система немедленно исключает его из ротации запросов.

2. **Перенаправление запросов**  
   При сбое узла запросы автоматически перенаправляются к доступным репликам на других узлах. Это происходит прозрачно для пользователя.

3. **Восстановление данных**  
   После устранения сбоя данные на узле синхронизируются с основными репликами, чтобы гарантировать целостность индекса.

4. **Географическая отказоустойчивость**  
   Если целый регион становится недоступным, запросы перенаправляются в другие регионы с минимальной задержкой.

## Настройка высокой доступности

AACSearch предоставляет настройки для повышения уровня доступности:

1. **Количество реплик**  
   Увеличьте число реплик для каждого индекса, чтобы повысить отказоустойчивость.

   ```json
   {
     "settings": {
       "numberOfReplicas": 3
     }
   }
   ```

2. **Географическое распределение узлов**  
   Настройте размещение узлов в нескольких регионах для защиты от локальных сбоев.

   ```json
   {
     "settings": {
       "regions": ["europe", "us-east", "asia"]
     }
   }
   ```

3. **Мониторинг и уведомления**  
   Настройте уведомления о сбоях через панель управления или API, чтобы оперативно реагировать на проблемы.
   ```json
   {
     "monitoring": {
       "alerts": {
         "nodeFailure": true,
         "regionOutage": true
       }
     }
   }
   ```

## Тестирование отказоустойчивости

- Проводите регулярные тесты отказоустойчивости, симулируя сбои узлов или регионов, чтобы убедиться, что система продолжает работать.
- Используйте встроенные инструменты аналитики для оценки времени восстановления после сбоев.

Для более детальной информации о высокой доступности обратитесь к [руководству по распределенному поиску](./distributed.md) и [архитектуре системы](./architecture.md).
