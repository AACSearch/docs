# API аналитики

API аналитики предоставляет доступ к статистике использования и инсайтам для ваших индексов AACSearch. Этот API позволяет получать данные о производительности поиска, поведении пользователей и других метриках для оптимизации вашего поискового опыта.

## Обзор

Данные аналитики помогают понять, как пользователи взаимодействуют с вашей функцией поиска, выявить популярные запросы и обнаружить области для улучшения в ваших индексах. API аналитики предлагает конечные точки для получения подробных отчетов и метрик.

- **Базовая конечная точка**: `/analytics`
- **Аутентификация**: Требуется API-ключ, передаваемый в заголовке как `X-API-Key`.

## Получение обзора аналитики

Получить сводку аналитики для вашего аккаунта AACSearch.

- **Конечная точка**: `GET /analytics`
- **Описание**: Возвращает обзор ключевых метрик по всем индексам, таких как общее количество поисков, среднее время ответа и популярные запросы.

### Запрос

```bash
curl -X GET "https://api.aacsearch.com/analytics" \
  -H "X-API-Key: your-api-key"
```

### Ответ

```json
{
  "overview": {
    "totalSearches": 12500,
    "averageResponseTimeMS": 12,
    "searchSuccessRate": 98.5,
    "totalIndexes": 3,
    "totalObjects": 4500
  },
  "popularQueries": [
    {
      "query": "смартфон",
      "count": 1500,
      "lastUsed": "2023-01-10T14:30:00Z"
    },
    { "query": "ноутбук", "count": 1200, "lastUsed": "2023-01-09T10:15:00Z" },
    { "query": "наушники", "count": 800, "lastUsed": "2023-01-08T09:45:00Z" }
  ],
  "period": {
    "start": "2023-01-01T00:00:00Z",
    "end": "2023-01-10T23:59:59Z"
  }
}
```

## Получение аналитики по конкретному индексу

Получить подробную аналитику для конкретного индекса.

- **Конечная точка**: `GET /analytics/index/{name}`
- **Описание**: Возвращает метрики и инсайты для указанного индекса, включая объем поиска, производительность запросов и использование фасетов.

### Запрос

```bash
curl -X GET "https://api.aacsearch.com/analytics/index/продукты" \
  -H "X-API-Key: your-api-key" \
  -G \
  -d "startDate=2023-01-01" \
  -d "endDate=2023-01-10"
```

### Ответ

```json
{
  "index": "продукты",
  "metrics": {
    "totalSearches": 8000,
    "averageResponseTimeMS": 10,
    "searchSuccessRate": 99.0,
    "totalObjects": 3000,
    "noResultRate": 5.2
  },
  "popularQueries": [
    { "query": "смартфон", "count": 1000, "noResults": 50 },
    { "query": "планшет", "count": 600, "noResults": 30 }
  ],
  "popularFilters": [
    { "filter": "category:электроника", "count": 2500 },
    { "filter": "price:100 TO 500", "count": 1800 }
  ],
  "popularFacets": [
    { "facet": "бренд", "count": 2000 },
    { "facet": "цена", "count": 1500 }
  ],
  "period": {
    "start": "2023-01-01T00:00:00Z",
    "end": "2023-01-10T23:59:59Z"
  }
}
```

## Получение отчета о производительности запросов

Получить подробный отчет о производительности запросов для выявления медленных или проблемных поисков.

- **Конечная точка**: `GET /analytics/queries`
- **Описание**: Возвращает список запросов с метриками производительности, такими как время ответа и процент успешных запросов. Можно фильтровать по индексу и диапазону дат.

### Запрос

```bash
curl -X GET "https://api.aacsearch.com/analytics/queries" \
  -H "X-API-Key: your-api-key" \
  -G \
  -d "index=продукты" \
  -d "startDate=2023-01-01" \
  -d "endDate=2023-01-10" \
  -d "sortBy=responseTime:desc" \
  -d "limit=5"
```

### Ответ

```json
{
  "queries": [
    {
      "query": "смартфон 5g ультра премиум",
      "count": 100,
      "averageResponseTimeMS": 25,
      "successRate": 95.0,
      "noResults": 10
    },
    {
      "query": "игровой ноутбук высокой производительности",
      "count": 80,
      "averageResponseTimeMS": 22,
      "successRate": 97.5,
      "noResults": 5
    },
    {
      "query": "беспроводные наушники с шумоподавлением",
      "count": 120,
      "averageResponseTimeMS": 20,
      "successRate": 98.3,
      "noResults": 3
    },
    {
      "query": "бюджетный смартфон до 200",
      "count": 150,
      "averageResponseTimeMS": 18,
      "successRate": 96.7,
      "noResults": 8
    },
    {
      "query": "планшет для детей",
      "count": 90,
      "averageResponseTimeMS": 15,
      "successRate": 99.0,
      "noResults": 2
    }
  ],
  "index": "продукты",
  "period": {
    "start": "2023-01-01T00:00:00Z",
    "end": "2023-01-10T23:59:59Z"
  },
  "totalQueries": 2500,
  "averageResponseTimeMS": 18.5
}
```

## Параметры для запросов аналитики

API аналитики поддерживает различные параметры для настройки получаемых данных:

- **`startDate`**: Дата начала периода аналитики (формат ISO 8601). Пример: `startDate=2023-01-01`.
- **`endDate`**: Дата окончания периода аналитики (формат ISO 8601). Пример: `endDate=2023-01-10`.
- **`index`**: Фильтрация аналитики по конкретному индексу. Пример: `index=продукты`.
- **`sortBy`**: Сортировка результатов по определенной метрике (например, `responseTime:desc` для убывания времени ответа). Пример: `sortBy=count:desc`.
- **`limit`**: Ограничение количества возвращаемых результатов. По умолчанию 10. Пример: `limit=5`.

## Лучшие практики использования аналитики

- **Регулярный мониторинг**: Проверяйте аналитику регулярно, чтобы выявлять тенденции в поведении пользователей и производительности поиска.
- **Оптимизация медленных запросов**: Используйте отчеты о производительности запросов, чтобы найти медленные или неуспешные поиски и соответственно настроить параметры индекса или структуру данных. Смотрите [API настроек](./settings.md) для опций оптимизации.
- **Фокус на запросах без результатов**: Анализируйте запросы с высоким процентом отсутствия результатов, чтобы улучшить покрытие данных или предложить синонимы. Смотрите [Синонимы](../guides/search/synonyms.md) для инструкций по настройке.
- **Пользовательские отчеты**: Используйте параметры диапазона дат для создания пользовательских отчетов для конкретных кампаний или временных периодов.

## Устранение неисправностей

Если вы столкнулись с проблемами с данными аналитики:

- Убедитесь, что ваш API-ключ имеет необходимые разрешения для доступа к аналитике.
- Проверьте, что диапазон дат и параметры индекса указаны правильно.
- Ознакомьтесь с разделом [Ошиб
